<!DOCTYPE html>
<html lang="en-us">
  
  <style>
    /* This is CSS that controls what the elements of the page that are defined in the HTML below look like. #name = html object with ID = name / .name = html object with class = name. Create two simple elements - title banner and a container that holds the map */
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        width: 100%;
        margin: 0;
        padding: 0;
          text-align: center;
        
      }
      #floating-panel {
        position: absolute;
        display:none;
        top: 10px;
        left: 25%;
        z-index: 5;
        background-color: #fff;
        padding: 5px;
        border: 1px solid #999;
        text-align: center;
        font-family: 'Roboto','sans-serif';
        line-height: 30px;
        padding-left: 10px;
      }
      #floating-panel {
        margin-left: -100px;
      }
      #eggsRemain{
          left: calc((100%-175px)/3);
      }
        #yourEggCount{
          left: calc((100%-175px)*(2/3));
      }
        .eggCounter{
          position: absolute;
          display: block;
          top: 20px;
          width: 175px;
          height: 50px;
          font-size: 18px;
          background-color: aliceblue;
          z-index: 20;
          font-family: 'Roboto','sans-serif';
          border-radius: 5px;
          padding-top: 4px;
          font-weight: 400;
        }
        #eggFound {
            background-image: url('EasterBackground.png');
        }
        #specialEggFound {
            background-image: url('specialEgg.png');
        }
        .eggPopup{
            display: none;
            position: absolute;           
            top: 15%;    
            z-index: 10;
            border-radius: 2%;
            width: 600px;
            height: 700px;
            left: calc((100% - 700px)/2);
            background-color: #fff8b4;
            padding: 5px;
            text-align: center;
            font-family: 'Roboto','sans-serif';
            font-size: 30px;
            line-height: 60px;
        }
        #closeButton {
            position: absolute;
            width: 45px;
            height: 45px;
            font-size: 30px;
            text-align: center;
            left: 650px;
            top: 10px;
            background-color: aliceblue;
            line-height: 45px;
        }
        input{
            width: 400px;
            height: 30px;
            padding: 10px;
            font-size: 20px;
            text-align: center;
            border: none;
            border-bottom: 2px solid red;
            border-radius: 10px;
            border-bottom-left-radius: 0px;
            border-bottom-right-radius: 0px;
        }
        #mySubmit{
            width: 150px;
            height: 80px;
            border: none;
            border-radius: 10px;
            background-color: pink;
            cursor: pointer;
        }
        #eggTitle{
            display: block;
            line-height: 20px;
            margin-top: 80px;
        }
        #foundMessage{
            font-size: 20px;
            line-height: 18px;
        }
        #intro{
            z-index: 10;
            font-size: 8px;
            padding-top: 100px;
        }
        #instructions{  
            z-index: 15;
            font-size: 14px;
            padding-top: 70px;
        }
        .startPopup{
            display:block;
            position: absolute;           
            top: 15%;
            line-height: 30px;
            padding: 30px;
            border-radius: 2%;
            width: 540px;
            height: 540px;
            left: calc((100% - 700px)/2);
            background-color: #fff8b4;
            background-image: url('EasterBackground.png');
            background-origin: border-box;
            background-repeat: no-repeat;
            background-size: 600px 700px;
            text-align: center;
            font-family: 'Roboto','sans-serif';
        }
        #introTitle{
            font-size: 30px;
            padding: 10px;
            
        }
        #emailloggingsubmit{
            width: 150px;
            height: 70px;
            border: none;
            border-radius: 10px;
            background-color: pink;
            cursor: pointer;
        }
        #introMessage{
            font-size: 18px;
        }
        #emaillogging{
            font-size: 18px;
        }
        .specialMessage{
            z-index: 1500;
             display:none;
             position: absolute;           
             top: 15%;
             border-radius: 2%;
            width: 900px;
            height: 700px;
            left: calc((100% - 900px)/2);
            color: white;
            background-color: #fff8b4;
            background-size: 900px 700px;
            background-origin: border-box;
            background-repeat: no-repeat;
            font-family: 'Roboto','sans-serif';
            font-size: 20px;
            line-height: 30px;
        }
        #allEggsFound{   
            background-image: url('allEggsFound.png');
          display: block;
        }

        #countdown{ 
            background-image: url('countdownBg.png');
        }
        #countdown > div{
            padding: 12px;
            border-radius: 3px;
            background: #00BF96;
            display: inline-block;
            width: 80px;
            margin-top: 420px;
            margin-left: 10px;
        }

        #countdown div > span{
            width: 23px;
            padding: 15px;
            border-radius: 3px;
            background: #00816A;
            display: inline-block;
        }
        .title{
            font-size: 50px;
            padding: 10px;
        }
        #formHashInput{
            display: none;
        }
        
    </style>
  
  
  <head>
    <meta charset="UTF-8">
    <title>Virtual Ustinov Day by mtztdiana</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  
  <body>
    <section class="page-header">
      <h1 class="project-name"> Virtual Ustinov Day </h1>
      <h2 class="project-tagline">Treasure Hunt </h2>
      <p><img src="petersafari.png" alt="Peter Safari" style="float:right;width:120px;height:120px;">
	      <img src="Crest_Text.jpg" alt="Ustinov GCR Loogo" style="float:left;width:120px;height:120px;"></p>
    </section>

    <section class="main-content">
      <h3> 
<a id="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Welcome to GitHub Pages.</h3>
<p>This automatic page generator is the easiest way to create beautiful pages for all of your projects. Author your page content here <a href="https://guides.github.com/features/mastering-markdown/">using GitHub Flavored Markdown</a>, select a template crafted by a designer, and publish. After your page is generated, you can check out the new <code>gh-pages</code> branch locally. If you’re using GitHub Desktop, simply sync your repository and you’ll see the new branch.</p>

      map {
  		display: inline;
	} <!-- Map Box -->
		
		<div id="eggClicked" class="eggPopup"> <!-- Popup when click on egg -->
			<div id="closeButton" onclick="closeWindow()" style = "cursor:pointer">X</div>
			<span id="foundTitle">Congratulations on finding a Peter! <p id="foundMessage"></p>
				<p id="introMessage"></p>
			</span>
		</div>
		
		<div id="firstClue"> <!-- Initial popup with first clue -->
			<div id="closeButton" onclick="closeWindow()" style = "cursor:pointer">X</div>
			<span id="foundTitle">Welcome to the Treasure Hunt <p id="foundMessage"></p>
				<p id="introMessage">Look around the start point for the first Peter</p>
			</span>
		</div>
      
      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/mtztdiana/VirtualUstinovDay">Virtual Ustinov Day</a> is maintained by <a href="https://github.com/mtztdiana">mtztdiana</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>
    </section>
 
  </body>
	
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> <!-- this just tells the code where it can find some of the commands used -->
    
    <script>
        //start of javascript
        
        // code copyright Huw Thomas 2020
        
        //First we need to define variables used - these are variables used in different functions of the code to store information too.
        
        var panorama; // google streetview object
        var clickedMarker; // id of egg that is clicked on
        var markers = []; // empty array to store markers in
        var locations; // will be array containing coordinates of eggs
        var clues; // will be array containing clues
        var currentEgg = 0; //tracks the number of eggs you have found
        
function initMap() {
    // This function gets the map set up on the screen
    
    var startpoint = {lat:54.774305, lng:-1.576349}; // this variable contains the latitude and longitude of the point at which the camera is on page load - i.e. the crossroads by the science site. This variable is only used within function initMap, which is why it is declared here, and not with the others above.
    var map = new google.maps.Map(document.getElementById('map'), {
          center: startpoint,
          zoom: 18,
          disableDefaultUI: true
        }); // This gets you a google map (not streetview)
    
    //Next we have the code for the image used for the egg - but you can change this image to be whatever you want. The scaledSize adjusts the size that the image appears on the map
    
    var icon = {
            url: 'petersafari.png', // egg image - this can also be an image saved in the same folder as your code i.e. url: 'egg.jpg',
            scaledSize: new google.maps.Size(130, 130), // scaled size
        };
    
    // Here are the locations of the eggs - each has a unique identifier code 'AB12' followed by the latitude and longitude - here are three around the start point for reference. They must be entered in the order you wish to find them.
    locations = [
        ['DM87', 54.774219, -1.576281],
        ['EC71', 54.774811, -1.576129],
        ['MP59', 54.776959, -1.575379],
        ['BB64', 54.768717, -1.573967],
        ['SS98', 54.768839, -1.569859],
        ['MC68', 54.766485, -1.560584],
        ['BG74', 54.762760, -1.574245],
        ['UC89', 54.768996, -1.590616]
    ];
    
    // can store a list of clues or something that correspond to each egg - i.e. the first clue corresponds to message that appears on finding the first egg in locations array (RS35). The clue to find the first egg is displayed when the page launches in div id="firstClue"
    clues = [
        ['The next Peter is by the entrance to the Castle'],
        ['The next Peter is enjoying the Durham Market Place'],
        ['The next Peter is going for some books at the Bill Bryson Library'],
        ['The next Peter is located by the entrance to the Science Site'],
        ['The next Peter is going to do some exercise at Maiden Castle'],
        ['The next Peter is planing to relax at the Botanic Garden'],
        ['The next Peter is visiting Sheraton Park'],
        ['Peter has return home! Game Over']
    ];
             
    
    
    var marker, i;
            
    // loop through eggs in locations matrix, set up a marker
    for (i=0; i<8; i++){
        marker = new google.maps.Marker({
            position: new google.maps.LatLng(locations[i][1], locations[i][2]), //Get latitude from second field in eahc row of locations array, and longitude from third field.
            map: map,
            icon: icon,
            title: locations[i][0] //Unique ID for marker from locations array
        });
        markers.push(marker); // store placed marker in array called markers
        
         google.maps.event.addListener(marker, 'click', (function(marker, i){ //if clicked on egg (marker) then do this function
            return function(){
                document.getElementById('eggClicked').style.display='block';  // show egg found panel
                
                // Get the unique code of the marker that has been clicked on
                var eggCode = locations[i][0];
                
                //increment egg counter
                currentEgg++
                
               // Can display a message saying which specific egg has been found in panel
                document.getElementById('foundMessage').innerHTML = 'You have found Peter: '+eggCode;
                
                // Display the next clue in panel - this displays the clue that corresponds to the egg that you have just found
                document.getElementById('introMessage').innerHTML = clues[i];
                
                // If you want to hide the egg that has just been clicked when found, the best way I found was just to resize the icon so its 0 in size -  if you don't just delete this section
                var newIcon = {url: 'petersafari.png', scaledSize: new google.maps.Size(0,0)};
                marker.setIcon(newIcon);
                 // hide egg from screen when clicked - marker will be removed on click
            }
         })(marker,i))
    }
    
    // Onclick Function
    document.addEventListener("click", function(){

        //get camera position
        position = panorama.getPosition();
        positionLat = position.lat();
        positionLong = position.lng();
        
        var minDist = 0.000225; // distance of camera from egg for egg to appear - the smaller minDist, the closer you must be to an egg for it to appear.
        
        // Loop through array of all markers and get coordinates for each    
         for (var m = 0; m<markers.length; m++){
             var markerPosition = markers[m].getPosition();
             var markerPositionLat = markerPosition.lat();
             var markerPositionLong = markerPosition.lng();
             // Calculate distance between camera position and marker
             var markerDistance = Math.sqrt(Math.pow((positionLat-markerPositionLat),2)+Math.pow((positionLong-markerPositionLong),2));
             // If distance < minimum distance, display egg, else hide egg
             
             // It may be that you want people to solve the clues in order - i.e. they can't find the next egg until they have found the previous one to stop them from just wandering about
             // using the currentEgg counter we can remove all eggs except the one you are currently looking for (the condition m===currentEgg)
             
             if (markerDistance < minDist && m === currentEgg){
                 markers[m].setVisible(true);
             } else {
                 markers[m].setVisible(false);
             }
             
             
         }      

        }); // End of document on click

        
        // Set up google street view and set visible.
            panorama = map.getStreetView();
            panorama.setPosition(startpoint);
            panorama.setPov(/** @type {google.maps.StreetViewPov} */({
              heading: 170,
              pitch: 0
            }));
            panorama.setVisible(true);

       }; // End map init function
        
        
    function closeWindow(){
       // Hide windows when close button pressed
        document.getElementById('firstClue').style.display='none';  
        document.getElementById('eggClicked').style.display='none'; 
    }
    
    </script>
    
    <!-- IMPORTANT: This is the Google Map API key - you will need to request one - FOLLOW THE INSTRUCTIONS HERE - you should be able to get free credits to get it with: https://developers.google.com/maps/documentation/javascript/get-api-key -->
 <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDNpJMal-GbCWUbgYAqpYkI_9lG357LTkY&callback=initMap" type="text/javascript">
    </script>
    
                
</html>
